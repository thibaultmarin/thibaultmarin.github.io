<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.43 in css mode. -->
<html>
  <head>
    <title>2016-11-13-Personal_website_in_org.org</title>
    <style type="text/css">
    <!--
      body {
        color: #657b83;
        background-color: #fdf6e3;
      }
      .ATTRLIST {
        /* (:background "#b0b0b0") */
        background-color: #b0b0b0;
      }
      .ATTRLIST-1 {
        /* (:background "#fefefe") */
        background-color: #fefefe;
      }
      .ATTRLIST-10 {
        /* (:background "#777777") */
        background-color: #777777;
      }
      .ATTRLIST-11 {
        /* (:background "#f1f1f1") */
        background-color: #f1f1f1;
      }
      .ATTRLIST-12 {
        /* (:background "#000080") */
        background-color: #000080;
      }
      .ATTRLIST-13 {
        /* (:background "#4C6FB0") */
        background-color: #4C6FB0;
      }
      .ATTRLIST-14 {
        /* (:background "#000000") */
        background-color: #000000;
      }
      .ATTRLIST-15 {
        /* (:foreground "white") */
        color: #ffffff;
      }
      .ATTRLIST-16 {
        /* (:background "#F1F1F1") */
        background-color: #F1F1F1;
      }
      .ATTRLIST-17 {
        /* (:background "#FFFFFF") */
        background-color: #FFFFFF;
      }
      .ATTRLIST-18 {
        /* (:foreground "black") */
        color: #000000;
      }
      .ATTRLIST-19 {
      }
      .ATTRLIST-2 {
        /* (:background "#616161") */
        background-color: #616161;
      }
      .ATTRLIST-3 {
        /* (:background "#808080") */
        background-color: #808080;
      }
      .ATTRLIST-4 {
        /* (:background "#A9A9A9") */
        background-color: #A9A9A9;
      }
      .ATTRLIST-5 {
        /* (:background "#fBF9E7") */
        background-color: #fBF9E7;
      }
      .ATTRLIST-6 {
        /* (:background "#4E4E4F") */
        background-color: #4E4E4F;
      }
      .ATTRLIST-7 {
        /* (:background "#111") */
        background-color: #111;
      }
      .ATTRLIST-8 {
        /* (:background "#333") */
        background-color: #333;
      }
      .ATTRLIST-9 {
        /* (:background "#555") */
        background-color: #555;
      }
      .builtin {
        /* font-lock-builtin-face */
        color: #483d8b;
      }
      .comment {
        /* font-lock-comment-face */
        color: #b22222;
      }
      .comment-delimiter {
        /* font-lock-comment-delimiter-face */
        color: #b22222;
      }
      .constant {
        /* font-lock-constant-face */
        color: #008b8b;
      }
      .css-property {
        /* css-property */
        color: #a0522d;
      }
      .css-selector {
        /* css-selector */
        color: #0000ff;
      }
      .doc {
        /* font-lock-doc-face */
        color: #8b2252;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #0000ff;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #a020f0;
      }
      .negation-char {
      }
      .org-block {
        /* org-block */
        color: #7f7f7f;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #b22222;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #b22222;
      }
      .org-code {
        /* org-code */
        color: #7f7f7f;
      }
      .org-date {
        /* org-date */
        color: #a020f0;
        text-decoration: underline;
      }
      .org-document-info {
        /* org-document-info */
        color: #191970;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #7f7f7f;
      }
      .org-document-title {
        /* org-document-title */
        color: #191970;
        font-weight: bold;
      }
      .org-done {
        /* org-done */
        color: #228b22;
        font-weight: bold;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #0000ff;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #a0522d;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #a020f0;
      }
      .org-level-4 {
        /* org-level-4 */
        color: #b22222;
      }
      .org-link {
        /* org-link */
        color: #3a5fcd;
        text-decoration: underline;
      }
      .org-list-dt {
        /* org-list-dt */
        font-weight: bold;
      }
      .org-macro {
        /* org-macro */
        color: #8b4513;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #b22222;
      }
      .org-property-value {
      }
      .org-special-keyword {
        /* org-special-keyword */
        color: #a020f0;
      }
      .org-tag {
        /* org-tag */
        font-weight: bold;
      }
      .org-verbatim {
        /* org-verbatim */
        color: #7f7f7f;
      }
      .regexp-grouping-backslash {
        /* font-lock-regexp-grouping-backslash */
        font-weight: bold;
      }
      .regexp-grouping-construct {
        /* font-lock-regexp-grouping-construct */
        font-weight: bold;
      }
      .string {
        /* font-lock-string-face */
        color: #8b2252;
      }
      .type {
        /* font-lock-type-face */
        color: #228b22;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #a0522d;
      }
      .warning {
        /* font-lock-warning-face */
        color: #ff0000;
        font-weight: bold;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-meta-line">#+INCLUDE: ../source-blocks.org</span>
<span class="org-meta-line">#+SETUPFILE: ../setup.org</span>
<span class="org-document-info-keyword">#+TITLE:</span> <span class="org-document-title">Personal website in org
</span><span class="org-document-info-keyword">#+DATE:</span> <span class="org-document-info">&lt;2016-11-13 Sun&gt;
</span><span class="org-meta-line">#+OPTIONS: ^:t H:4</span>
<span class="org-meta-line">#+TODO: TODO REVIEW | DONE DEFERRED ABANDONED</span>
<span class="org-meta-line">#+PROPERTY: COOKIE_DATA todo recursive</span>
<span class="org-meta-line">#+PROPERTY: header-args+ :exports code</span>
<span class="org-meta-line">#+PROPERTY: header-args+ :comments link</span>
<span class="org-meta-line">#+STARTUP: hideblocks</span>
<span class="org-meta-line">#+MACRO: tt \nbsp{}</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Introduction</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">bee322f3-5c88-4db6-85bb-96ccd5204aa3</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-01 Sat 14:55&gt;</span>
<span class="org-special-keyword">:END:</span>

This post describes the configuration for this website, which is statically
generated using emacs and org-mode.  Org-mode's publishing functionality is used
to generate the HTML content from source <span class="org-verbatim">=org=</span> files.  Here is a list of
existing examples that I have used to build this website:

- <span class="org-link"><a href="http://bastibe.de/2013-11-13-blogging-with-emacs.html">http://bastibe.de/2013-11-13-blogging-with-emacs.html</a></span>
- <span class="org-link"><a href="http://emacs-doctor.com/blogging-from-emacs.html">http://emacs-doctor.com/blogging-from-emacs.html</a></span>
- <span class="org-link"><a href="http://endlessparentheses.com/how-i-blog-one-year-of-posts-in-a-single-org-file.html">http://endlessparentheses.com/how-i-blog-one-year-of-posts-in-a-single-org-file.html</a></span>
- <span class="org-link"><a href="https://github.com/howardabrams/dot-files/blob/master/emacs-blog.org">https://github.com/howardabrams/dot-files/blob/master/emacs-blog.org</a></span>
- <span class="org-link"><a href="http://www.john2x.com/blog/blogging-with-orgmode.html">http://www.john2x.com/blog/blogging-with-orgmode.html</a></span>
- <span class="org-link"><a href="https://ogbe.net/blog/blogging_with_org.html">https://ogbe.net/blog/blogging_with_org.html</a></span>
- <span class="org-link"><a href="http://nicolas.petton.fr/blog/blogging-with-org-mode.html">http://nicolas.petton.fr/blog/blogging-with-org-mode.html</a></span>

As for other posts in this website, the actual configuration files, including
emacs-lisp configuration, CSS, etc. can be generated by tangling the org-file
(<span class="org-verbatim">=org-babel-tangle=</span> bound to <span class="org-macro">{{{kbd("C-c C-v t")}}}</span> by default).

The folder structure is similar to the one described in the <span class="org-link"><a href="http://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html">Worg tutorial</a></span>: the
website source is composed of org files with the following structure:

<span class="org-meta-line">#+NAME: sh-tree</span>
<span class="org-block-begin-line">#+BEGIN_SRC sh :results verbatim :exports both
</span><span class="org-block">tree -a org/ -I </span><span class="string"><span class="org-block">"*~"</span></span><span class="org-block">
</span><span class="org-block-end-line">#+END_SRC
</span>
<span class="org-meta-line">#+RESULTS: sh-tree</span>
<span class="org-block-begin-line">#+BEGIN_EXAMPLE
</span><span class="ATTRLIST-19">org/
&#9500;&#9472;&#9472; blog.org
&#9500;&#9472;&#9472; css
&#9474;&#160;&#160; &#9492;&#9472;&#9472; site.css
&#9500;&#9472;&#9472; html
&#9474;&#160;&#160; &#9500;&#9472;&#9472; html_head.html
&#9474;&#160;&#160; &#9500;&#9472;&#9472; html_postamble.html
&#9474;&#160;&#160; &#9492;&#9472;&#9472; html_preamble.html
&#9500;&#9472;&#9472; images
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 2016-10-05-Awesome-wm_configuration
&#9474;&#160;&#160; &#9474;&#160;&#160; &#9500;&#9472;&#9472; desktop-cmus-popup.png
&#9474;&#160;&#160; &#9474;&#160;&#160; &#9500;&#9472;&#9472; desktop-confirm_action.png
&#9474;&#160;&#160; &#9474;&#160;&#160; &#9500;&#9472;&#9472; desktop-global_prompt-help.png
&#9474;&#160;&#160; &#9474;&#160;&#160; &#9500;&#9472;&#9472; desktop-main.png
&#9474;&#160;&#160; &#9474;&#160;&#160; &#9492;&#9472;&#9472; desktop-wibox.png
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 2016-11-13-Personal_website_in_org
&#9474;&#160;&#160; &#9474;&#160;&#160; &#9492;&#9472;&#9472; website-post.png
&#9474;&#160;&#160; &#9492;&#9472;&#9472; feed-icon-28x28.png
&#9500;&#9472;&#9472; index.org
&#9500;&#9472;&#9472; js
&#9474;&#160;&#160; &#9492;&#9472;&#9472; org-info.js
&#9500;&#9472;&#9472; posts
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 2016-10-05-Awesome-wm_configuration.org
&#9474;&#160;&#160; &#9492;&#9472;&#9472; 2016-11-13-Personal_website_in_org.org
&#9500;&#9472;&#9472; rss.org
&#9500;&#9472;&#9472; setup.org
&#9492;&#9472;&#9472; sitemap.org

7 directories, 19 files
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
The start page is the index.org file, which is described <span class="org-link"><a href="nil:nil">later</a></span>.  It includes
links to the different pages, and a list of recent blog posts.  Blog posts are
located in the <span class="org-verbatim">=posts/=</span> folder, where each file contains a single post and the
filename is prefixed by the post date.  Attachments for blog posts (e.g. images)
are placed in the <span class="org-verbatim">=images/=</span> folder with a subfolder corresponding to the post
filename.  Blog posts are pushed to the blog from regular org files using a
<span class="org-link"><a href="nil:nil">custom function</a></span> which handles file naming and attachments.  Finally, the static
content is located in the <span class="org-verbatim">=css/=</span>, <span class="org-verbatim">=js/=</span> and <span class="org-verbatim">=html/=</span> folders.

The workflow I use to update this website is as follows:
- for basic webpages (i.e. everything but the blog posts), edit the org files in
  the source tree,
- for blog posts, create a standalone org file outside of the website source
  tree, then push it using the <span class="org-link"><a href="nil:nil">push-to-blog</a></span> function, which handles file links
  and adds boilerplate options to the org file before moving the processed org
  file to the website source tree,
- finally run the <span class="org-link"><a href="nil:nil">publishing wrapper function</a></span> to generate the website,
- optionally push the changes to the actual server (e.g. github pages).


<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Style</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes :tangle org/css/site.css</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">d87746eb-1ea4-4db0-9ee8-75f3cf74d49b</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-01 Sat 14:55&gt;</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">css</span>
<span class="org-special-keyword">:END:</span>

The styling of the website is done in CSS, the goal being to make it modular
rather than aesthetically pleasing (as visible on Fig.<span class="org-macro">{{{tt}}}</span><span class="org-link"><a href="nil:nil">fig-website-post</a></span>).
When tangled, this section generates the <span class="org-verbatim">=site.css=</span> used for styling.

<span class="org-meta-line">#+NAME: fig-website-post</span>
<span class="org-meta-line">#+ATTR_HTML: :width 80%</span>
<span class="org-meta-line">#+CAPTION:</span> <span class="org-block">Screenshot of a post.</span>
<span class="org-link"><a href="file:../images/2016-11-13-Personal_website_in_org/website-post.png">file:../images/2016-11-13-Personal_website_in_org/website-post.png</a></span>

The website design is "responsive": the layout varies based on the client's
size.  Three client sizes are considered: large (width $\geq$ 1024 px), medium
(600 px $\leq$ width $&lt;$ 1024 px) and small (width $&lt;$ 600 px).

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Variables</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">cb63337a-a5db-48d4-acbf-619dbbc2af8e</span>
<span class="org-special-keyword">:END:</span>

Most of the properties used for styling are defined at the top of the style
file.  This could be done via org variables passed to the CSS source block, but
<span class="org-verbatim">=ob-css=</span> does not support this (it seems that it could be added with minimal
effort for scalar variables at least).

<span class="comment"># Need to split variables</span>

<span class="org-meta-line">#+NAME: style-css-variables</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="comment-delimiter"><span class="org-block">/** </span></span><span class="comment"><span class="org-block">CSS variables
 ,</span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="css-selector"><span class="org-block">

:root </span></span><span class="org-block">{
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Body </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">---- </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--body-bg</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-17"><span class="org-block">white</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--content-padding</span></span><span class="org-block">: 10px;
    </span><span class="variable-name"><span class="org-block">--content-bg</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-16"><span class="org-block">#F1F1F1</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--content-box-shadow</span></span><span class="org-block">: 0;
    </span><span class="variable-name"><span class="org-block">--body-margin</span></span><span class="org-block">: 30px; </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">not used for small screens </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Footer </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">------ </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--footer-border</span></span><span class="org-block">: 1px solid </span><span class="ATTRLIST-15"><span class="ATTRLIST-14"><span class="org-block">black</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--footer-padding</span></span><span class="org-block">: 10px;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-bg</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-13"><span class="org-block">#4C6FB0</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-bg-hover</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-12"><span class="org-block">navy</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-padding</span></span><span class="org-block">: 5px 10px;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-color</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-17"><span class="org-block">white</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-font-size</span></span><span class="org-block">: 90%;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-border</span></span><span class="org-block">: 2px solid </span><span class="ATTRLIST-15"><span class="ATTRLIST-12"><span class="org-block">navy</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--footer-buttons-min-width</span></span><span class="org-block">: 270px;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Table of contents </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">----------------- </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Basic style </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--toc-bg</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-11"><span class="org-block">#f1f1f1</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--toc-box-shadow</span></span><span class="org-block">: 0 0 0.8em </span><span class="ATTRLIST-15"><span class="ATTRLIST-10"><span class="org-block">#777777</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--toc-border-radius</span></span><span class="org-block">: 5px;
    </span><span class="variable-name"><span class="org-block">--toc-li-color</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-14"><span class="org-block">black</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--toc-hover-bg-color</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-9"><span class="org-block">#555</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--toc-hover-color</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-17"><span class="org-block">white</span></span></span><span class="org-block">;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Layout </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--toc-nav-vspacing</span></span><span class="org-block">: 20px;
    </span><span class="variable-name"><span class="org-block">--toc-base-padding</span></span><span class="org-block">: 5px;
    </span><span class="variable-name"><span class="org-block">--toc-ul-padding-left</span></span><span class="org-block">: 20px;
    </span><span class="variable-name"><span class="org-block">--toc-local-padding</span></span><span class="org-block">: 5px;
    </span><span class="variable-name"><span class="org-block">--toc-extra-padding-x</span></span><span class="org-block">: 4px;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Navigation bar </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">-------------- </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Basic style </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--nav-bg</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-8"><span class="org-block">#333</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--nav-hover</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-7"><span class="org-block">#111</span></span></span><span class="org-block">;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">RSS </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">--- </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--rss-img</span></span><span class="org-block">: url(</span><span class="string"><span class="org-block">"/blog/images/feed-icon-28x28.png"</span></span><span class="org-block">);

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Org-js </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">------ </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--org-js-console-bg</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-bg</span></span><span class="org-block">);

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Fonts </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">----- </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Text </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--font-body-family</span></span><span class="org-block">: Arial, sans-serif;
    </span><span class="variable-name"><span class="org-block">--font-body-size</span></span><span class="org-block">: 16pt;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Code </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--font-code-family</span></span><span class="org-block">: DejaVu, Lucida Console, monospace;
    </span><span class="variable-name"><span class="org-block">--font-code-color</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-6"><span class="org-block">#4E4E4F</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--font-code-size</span></span><span class="org-block">: 14pt;
    </span><span class="variable-name"><span class="org-block">--font-src-family</span></span><span class="org-block">: DejaVu, Lucida Console, monospace;
    </span><span class="variable-name"><span class="org-block">--font-example-family</span></span><span class="org-block">: DejaVu, Lucida Console, monospace;
    </span><span class="variable-name"><span class="org-block">--font-example-size</span></span><span class="org-block">: 11pt;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Links </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--font-a-color</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-12"><span class="org-block">navy</span></span></span><span class="org-block">;

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Color scheme </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">------------ </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

    </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Source blocks </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
    </span><span class="variable-name"><span class="org-block">--src-bg</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-5"><span class="org-block">#fBF9E7</span></span></span><span class="org-block">;
    </span><span class="variable-name"><span class="org-block">--lua-bg</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--src-bg</span></span><span class="org-block">);

}

</span><span class="comment-delimiter"><span class="org-block">/** </span></span><span class="comment"><span class="org-block">Responsive variables
 ,</span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Large screens </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> (min-width: 1024px) {
    :root {
        </span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">: 250px;
        </span><span class="variable-name"><span class="org-block">--body-width</span></span><span class="org-block">: 60%;
        </span><span class="variable-name"><span class="org-block">--nav-base-font-size</span></span><span class="org-block">: 80%;
        </span><span class="variable-name"><span class="org-block">--nav-height</span></span><span class="org-block">: 50px;
        </span><span class="variable-name"><span class="org-block">--nav-padding</span></span><span class="org-block">: 14px 16px;
        </span><span class="variable-name"><span class="org-block">--toc-base-font-size</span></span><span class="org-block">: 70%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-font-size</span></span><span class="org-block">: 150%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-local-font-size</span></span><span class="org-block">: 130%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-2-font-size</span></span><span class="org-block">: 80%;
        </span><span class="variable-name"><span class="org-block">--font-src-size</span></span><span class="org-block">: 11pt;
        </span><span class="variable-name"><span class="org-block">--rss-padding</span></span><span class="org-block">: 0 0 0 25px;
        </span><span class="variable-name"><span class="org-block">--rss-size</span></span><span class="org-block">: 25px 25px;
        </span><span class="variable-name"><span class="org-block">--rss-pos</span></span><span class="org-block">: 50%;
    }
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Medium screens </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> (min-width: 600px) and (max-width: 1024px) {
    :root {
        </span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">: 150px;
        </span><span class="variable-name"><span class="org-block">--body-width</span></span><span class="org-block">: calc(92% - var(</span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">));
        </span><span class="variable-name"><span class="org-block">--nav-base-font-size</span></span><span class="org-block">: 70%;
        </span><span class="variable-name"><span class="org-block">--nav-height</span></span><span class="org-block">: 30px;
        </span><span class="variable-name"><span class="org-block">--nav-padding</span></span><span class="org-block">: 5px 6px;
        </span><span class="variable-name"><span class="org-block">--toc-base-font-size</span></span><span class="org-block">: 70%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-font-size</span></span><span class="org-block">: 130%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-local-font-size</span></span><span class="org-block">: 130%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-2-font-size</span></span><span class="org-block">: 80%;
        </span><span class="variable-name"><span class="org-block">--font-src-size</span></span><span class="org-block">: 11pt;
        </span><span class="variable-name"><span class="org-block">--rss-padding</span></span><span class="org-block">: 0 0 19px 9px;
        </span><span class="variable-name"><span class="org-block">--rss-size</span></span><span class="org-block">: 10px 10px;
        </span><span class="variable-name"><span class="org-block">--rss-pos</span></span><span class="org-block">: 25%;
    }
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Small screens </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> (max-width: 600px) {
    :root {
        </span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">: 150px; </span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">unused in this case </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
        </span><span class="variable-name"><span class="org-block">--body-width</span></span><span class="org-block">: 100%;
        </span><span class="variable-name"><span class="org-block">--nav-base-font-size</span></span><span class="org-block">: 80%;
        </span><span class="variable-name"><span class="org-block">--nav-height</span></span><span class="org-block">: 30px;
        </span><span class="variable-name"><span class="org-block">--nav-padding</span></span><span class="org-block">: 5px 6px;
        </span><span class="variable-name"><span class="org-block">--toc-base-font-size</span></span><span class="org-block">: 80%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-font-size</span></span><span class="org-block">: 120%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-local-font-size</span></span><span class="org-block">: 130%;
        </span><span class="variable-name"><span class="org-block">--toc-ul-2-font-size</span></span><span class="org-block">: 80%;
        </span><span class="variable-name"><span class="org-block">--font-src-size</span></span><span class="org-block">: 10pt;
        </span><span class="variable-name"><span class="org-block">--rss-padding</span></span><span class="org-block">: 0 0 19px 20px;
        </span><span class="variable-name"><span class="org-block">--rss-size</span></span><span class="org-block">: 20px 20px;
        </span><span class="variable-name"><span class="org-block">--rss-pos</span></span><span class="org-block">: 19%;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Table of contents</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">e2781b6f-6b0e-4705-84cf-f662f6c94a88</span>
<span class="org-special-keyword">:END:</span>

Exported pages use <span class="org-link"><a href="http://orgmode.org/worg/code/org-info-js/">org-infojs</a></span> for navigation.  It comes with a nice table of
contents for the document (with CSS id <span class="org-verbatim">=#table-of-contents=</span>).  Similar to the
fixed table of contents used on the <span class="org-link"><a href="http://orgmode.org/worg/">Worg website</a></span>, it is fixed on one side of the
page.

A local table of contents for each section is also used (since blog posts tend
to be quite lengthy), and styled in a similar fashion.  The relevant CSS class
is <span class="org-verbatim">=.org-info-js_local-toc=</span>.

The table of contents is "responsive" as it adapts to the viewport (client)
size:
- Fixed vertical menu for large screens
- Reduce to single level table on medium size screens
- Collapse to regular section (floating) for small screens


<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Basic style</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">cda2e81d-7dd7-497a-8891-2d2d940c856a</span>
<span class="org-special-keyword">:END:</span>

First, we define the basic styling properties for the table of contents: color,
shadow, size, etc.

<span class="org-meta-line">#+NAME: style-css-toc</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="comment-delimiter"><span class="org-block">/** </span></span><span class="comment"><span class="org-block">Table of content
 ,</span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Basic styling (color, font, shadow) common to global and local TOC </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#table-of-contents, .org-info-js_local-toc </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-bg</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">box-shadow</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-box-shadow</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">border-bottom-left-radius</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-border-radius</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-base-font-size</span></span><span class="org-block">);
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Size (global TOC only) </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#table-of-contents </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">width</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">.org-info-js_local-toc </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-local-padding</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Position</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">75a4b1a4-b337-4e27-a68c-d2fb293813c0</span>
<span class="org-special-keyword">:END:</span>

The placement of the table of contents depends on the screen size: the different
definitions are placed here.

<span class="org-level-4">**** </span><span class="org-done">DONE</span><span class="org-level-4"> Large screen</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">ab5fa256-502d-4c13-86ef-53339df52a2c</span>
<span class="org-special-keyword">:END:</span>

For medium and large screens, the table of contents is fixed on the left of the
screen.

<span class="org-meta-line">#+NAME: style-css-toc-layout_large</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Fixed vertical table of content </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> screen and (min-width: 600px) {
    </span><span class="css-selector"><span class="org-block">#table-of-contents </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: fixed;
        </span><span class="css-property"><span class="org-block">left</span></span><span class="org-block">: 0;
        </span><span class="css-property"><span class="org-block">top</span></span><span class="org-block">: calc(var(</span><span class="variable-name"><span class="org-block">--nav-height</span></span><span class="org-block">) + var(</span><span class="variable-name"><span class="org-block">--toc-nav-vspacing</span></span><span class="org-block">));
        </span><span class="css-property"><span class="org-block">bottom</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-nav-vspacing</span></span><span class="org-block">);
        </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-base-padding</span></span><span class="org-block">);
        </span><span class="css-property"><span class="org-block">overflow</span></span><span class="org-block">: auto;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-4">**** </span><span class="org-done">DONE</span><span class="org-level-4"> Medium screen</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">14d429ec-fcb5-48a1-be13-e429fadea414</span>
<span class="org-special-keyword">:END:</span>

For medium and small screens, the table of contents is limited to only top level
headings.

<span class="org-meta-line">#+NAME: style-css-toc-layout_medium</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> screen and (max-width: 1024px) {
    </span><span class="css-selector"><span class="org-block">#table-of-contents &gt; div &gt; ul &gt; li &gt; ul </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">display</span></span><span class="org-block">: none;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-4">**** </span><span class="org-done">DONE</span><span class="org-level-4"> Small screen</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">868b5c03-dd76-4d1d-b849-e1929795c7ae</span>
<span class="org-special-keyword">:END:</span>

For small screens, the table of contents is a regular section, and it is set to
use (almost) all the available width.

<span class="org-meta-line">#+NAME: style-css-toc-layout_small</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> screen and (max-width: 600px) {
    </span><span class="css-selector"><span class="org-block">#table-of-contents </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: relative;
        </span><span class="css-property"><span class="org-block">width</span></span><span class="org-block">: 90%;
        </span><span class="css-property"><span class="org-block">margin</span></span><span class="org-block">: auto;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> List style</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">971e4499-d7fa-43fc-97fb-f0271db7c212</span>
<span class="org-special-keyword">:END:</span>

The style for entries in the table of contents are defined here.  The following
block sets font sizes and alignment.

<span class="org-meta-line">#+NAME: style-css-toc-ul</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#table-of-contents ul, .org-info-js_local-toc ul </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">list-style-type</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">margin</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">padding-left</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-ul-padding-left</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">#table-of-contents ul </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-ul-font-size</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">.org-info-js_local-toc ul </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-ul-local-font-size</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">#table-of-contents &gt; div &gt; ul, .org-info-js_local-toc &gt; div &gt; ul </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">list-style-type</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">margin</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">padding-left</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-extra-padding-x</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">#table-of-contents &gt; div &gt; ul &gt; li &gt; ul</span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-ul-2-font-size</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
}
</span><span class="org-block-end-line">#+END_SRC
</span>
The appearance of links is defined here:

<span class="org-meta-line">#+NAME: style-css-toc-li</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#table-of-contents li a, .org-info-js_local-toc li a </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">display</span></span><span class="org-block">: block;
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-li-color</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">text-decoration</span></span><span class="org-block">: none;
}

</span><span class="css-selector"><span class="org-block">#table-of-contents li a </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
}

</span><span class="css-selector"><span class="org-block">#table-of-contents li a:hover:not(.active), .org-info-js_local-toc li a:hover:not(.active) </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-hover-bg-color</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--toc-hover-color</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Navigation bar</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">eb314cce-91d0-47ec-81fe-52ea6ce8cb10</span>
<span class="org-special-keyword">:END:</span>

A small navigation bar is added to all pages in the website (on the top left
corner).  It contains links to the home page, a list of blog posts and the RSS
feed.  As for the table of contents, its sizes decreases for medium size
clients, and collapses to a floating menu at the top for small clients.

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Basic style</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">71b62fa3-83e7-4472-92de-dbbede6a7601</span>
<span class="org-special-keyword">:END:</span>

First, the basic style elements are defined, including the position, size, color
and text alignment.

<span class="org-meta-line">#+NAME: style-css-navbar</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="comment-delimiter"><span class="org-block">/** </span></span><span class="comment"><span class="org-block">Navigation bar
 ,</span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="css-selector"><span class="org-block">

.topnav </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">top</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">left</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">max-height</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--nav-height</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--nav-bg</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">width</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--nav-base-font-size</span></span><span class="org-block">);
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">RSS icon </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">.feed </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">margin-left</span></span><span class="org-block">: 3px;
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--rss-padding</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">background</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--rss-img</span></span><span class="org-block">) no-repeat 0 var(</span><span class="variable-name"><span class="org-block">--rss-pos</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">background-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--rss-size</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Position</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">3c9e02b8-0849-4e35-9cdc-bf4f0d9627c7</span>
<span class="org-special-keyword">:END:</span>

<span class="org-level-4">**** </span><span class="org-done">DONE</span><span class="org-level-4"> Medium and large screen</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">af3932bf-610f-4ac6-bf2c-63433f1b611d</span>
<span class="org-special-keyword">:END:</span>

For medium and large screens, the navigation bar is fixed on the top left
corner.

<span class="org-meta-line">#+NAME: style-css-navbar-large</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> screen and (min-width: 600px) {
    </span><span class="css-selector"><span class="org-block">.topnav </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: fixed;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-4">**** </span><span class="org-done">DONE</span><span class="org-level-4"> Small screen</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">6a5b666d-440b-4ff7-bef9-99d9ac7d0a3d</span>
<span class="org-special-keyword">:END:</span>

For small screens, the navigation bar is placed at the top, and made floating.

<span class="org-meta-line">#+NAME: style-css-navbar-small</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> screen and (max-width: 600px) {
    </span><span class="css-selector"><span class="org-block">.topnav </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: relative;
        </span><span class="css-property"><span class="org-block">width</span></span><span class="org-block">: 100%;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> List style</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">b3878dce-bc15-4854-81eb-b91c7dbe229d</span>
<span class="org-special-keyword">:END:</span>

The following block sets the style of the navigation items.

<span class="org-meta-line">#+NAME: style-css-navbar-ul</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="css-selector"><span class="org-block">.topnav ul </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">list-style-type</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">margin</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">overflow</span></span><span class="org-block">: hidden;
    </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: relative;
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
}

</span><span class="css-selector"><span class="org-block">.topnav li </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">float</span></span><span class="org-block">: left;
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
    </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: relative;
}
</span><span class="org-block-end-line">#+END_SRC
</span>
<span class="org-meta-line">#+NAME: style-css-navbar-li</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="css-selector"><span class="org-block">.topnav li a </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">display</span></span><span class="org-block">: block;
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-17"><span class="org-block">white</span></span></span><span class="org-block">;
    </span><span class="css-property"><span class="org-block">text-align</span></span><span class="org-block">: left;
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--nav-padding</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">text-decoration</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">position</span></span><span class="org-block">: relative;
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
}

</span><span class="css-selector"><span class="org-block">.topnav li a:hover:not(.active) </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--nav-hover</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">.topnav .right </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">float</span></span><span class="org-block">: right;
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Source blocks</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">55a06366-98b3-46fc-9f6e-a07d6abd2c18</span>
<span class="org-special-keyword">:END:</span>

This section defines the appearance of source blocks in the rendered HTML.  The
main features are:
- allow scrollbars on overflow,
- move the tooltip with the language inside the div block,
- set colors for the background and the filename label (see the
  <span class="org-link"><a href="nil:nil">source labeling setup</a></span> section).

<span class="org-meta-line">#+NAME: style-css-src-block</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="css-selector"><span class="org-block">pre.src </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">overflow-x</span></span><span class="org-block">: auto;
}

</span><span class="css-selector"><span class="org-block">pre.src:before </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">top</span></span><span class="org-block">: 0;
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Source block color based on file type </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">pre.src.src.src-lua </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--lua-bg</span></span><span class="org-block">);
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Source block label </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">.src-label </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-4"><span class="org-block">darkgray</span></span></span><span class="org-block">;
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Org-js</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">5b1786d0-71b6-4a5d-b506-a91cf3a40546</span>
<span class="org-special-keyword">:END:</span>

The org-infojs tool inserts a search box in the rendered html.  It is used for
search operations.  The following sets the default location for the search box.

<span class="org-meta-line">#+NAME: style-css-org-js</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#org-info-js_console-container </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">bottom</span></span><span class="org-block">: 0;
    </span><span class="css-property"><span class="org-block">margin-top</span></span><span class="org-block">: 0;
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Body</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">3e911a21-793c-4bb5-87dd-d95e38bcaf1b</span>
<span class="org-special-keyword">:END:</span>

The following CSS controls the size of the body, which adapts to the client
size.

<span class="org-meta-line">#+NAME: style-css-body</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Body </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">body </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">width</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--body-width</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">overflow-x</span></span><span class="org-block">: hidden;
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--body-bg</span></span><span class="org-block">);
}

</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> (min-width: 600px) {
    </span><span class="css-selector"><span class="org-block">body </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">margin-left</span></span><span class="org-block">: calc(var(</span><span class="variable-name"><span class="org-block">--side-width</span></span><span class="org-block">) + var(</span><span class="variable-name"><span class="org-block">--body-margin</span></span><span class="org-block">));
        </span><span class="css-property"><span class="org-block">margin-right</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--body-margin</span></span><span class="org-block">);
    }
}

</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> (max-width: 600px) {
    </span><span class="css-selector"><span class="org-block">body </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">margin-left</span></span><span class="org-block">: 0;
        </span><span class="css-property"><span class="org-block">margin-right</span></span><span class="org-block">: 0;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Preamble</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">f65fbe40-7980-450f-9b0e-5b40caf9f9da</span>
<span class="org-special-keyword">:END:</span>

The preamble is a text added to the top of the page.  The actual content is
defined in the <span class="org-link"><a href="nil:nil">HTML preamble section</a></span>.

<span class="org-meta-line">#+NAME: style-css-preamble</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Text before post (date and help) </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">.foreword </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-3"><span class="org-block">gray</span></span></span><span class="org-block">;
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: 80%;
}
</span><span class="org-block-end-line">#+END_SRC
</span>
The <span class="org-verbatim">=home=/=up=</span> buttons are hidden for small clients.

<span class="org-meta-line">#+NAME: style-css-home-up</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="builtin"><span class="org-block">@media</span></span><span class="org-block"> screen and (max-width: 600px) {
    </span><span class="css-selector"><span class="org-block">#org-div-home-and-up </span></span><span class="org-block">{
        </span><span class="css-property"><span class="org-block">display</span></span><span class="org-block">: none;
    }
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Content</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">5c01f512-8351-48e9-9c2a-e3a4a669d974</span>
<span class="org-special-keyword">:END:</span>

The following block is used to limit the width of the main content and add a
background color.

<span class="org-meta-line">#+NAME: style-css-content</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Main content </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#content </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--content-bg</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">box-shadow</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--content-box-shadow</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">padding-left</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--content-padding</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">padding-right</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--content-padding</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Postamble</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">4e87e731-c88f-4c68-bdeb-39c02f64ca57</span>
<span class="org-special-keyword">:END:</span>

This section defines the layout of the <span class="org-link"><a href="nil:nil">HTML postamble</a></span> used on all pages.

<span class="org-meta-line">#+NAME: style-css-postamble</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="css-selector"><span class="org-block">#postamble </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-padding</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">border</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-border</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Fonts</span>

Here, the fonts for text, links and code are selected.

<span class="org-meta-line">#+NAME: style-css-fonts</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Fonts </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">body </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-family</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-body-family</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-body-size</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">code </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-family</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-code-family</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-code-size</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-code-color</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">pre.src </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-family</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-src-family</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-src-size</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--src-bg</span></span><span class="org-block">);
}

</span><span class="css-selector"><span class="org-block">pre.example </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-family</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-example-family</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-example-size</span></span><span class="org-block">);
}

</span><span class="comment-delimiter"><span class="org-block">/* </span></span><span class="comment"><span class="org-block">Links </span></span><span class="comment-delimiter"><span class="org-block">*/</span></span><span class="org-block">
</span><span class="css-selector"><span class="org-block">a </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">text-decoration</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--font-a-color</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> HTML tags</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">7c0f16bb-f153-4eab-a554-82eef98f782b</span>
<span class="org-special-keyword">:END:</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Buttons</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">f9d92e98-006d-4a67-b76d-e66ebc558c4a</span>
<span class="org-special-keyword">:END:</span>

The <span class="org-link"><a href="nil:nil">HTML postamble</a></span> uses buttons to view the page org source; their appearance is
defined here:

<span class="org-meta-line">#+NAME: style-css-button</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="css-selector"><span class="org-block">.footer-button </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">border</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">text-align</span></span><span class="org-block">: center;
    </span><span class="css-property"><span class="org-block">text-decoration</span></span><span class="org-block">: none;
    </span><span class="css-property"><span class="org-block">display</span></span><span class="org-block">: inline-block;
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-bg</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-color</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-padding</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">font-size</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-font-size</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">border</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-border</span></span><span class="org-block">);
    </span><span class="css-property"><span class="org-block">min-width</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-min-width</span></span><span class="org-block">);
}
</span><span class="css-selector"><span class="org-block">.footer-button:hover </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: var(</span><span class="variable-name"><span class="org-block">--footer-buttons-bg-hover</span></span><span class="org-block">);
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Keyboard shortcut (</span><span class="org-verbatim"><span class="org-level-3">=&lt;kbd&gt;=</span></span><span class="org-level-3">)</span>

Define a simple css style for the html <span class="org-code">~&lt;kbd&gt;~</span> tag.

<span class="org-meta-line">#+NAME: style-css-kbd</span>
<span class="org-block-begin-line">#+BEGIN_SRC css
</span><span class="org-block">
</span><span class="css-selector"><span class="org-block">kbd </span></span><span class="org-block">{
    </span><span class="css-property"><span class="org-block">font-family</span></span><span class="org-block">: DejaVu, Lucida Console, monospace;
    </span><span class="css-property"><span class="org-block">display</span></span><span class="org-block">: inline-block;
    </span><span class="css-property"><span class="org-block">padding</span></span><span class="org-block">: 1px 4px;
    </span><span class="css-property"><span class="org-block">color</span></span><span class="org-block">: </span><span class="ATTRLIST-15"><span class="ATTRLIST-2"><span class="org-block">#616161</span></span></span><span class="org-block">;
    </span><span class="css-property"><span class="org-block">vertical-align</span></span><span class="org-block">: middle;
    </span><span class="css-property"><span class="org-block">background-color</span></span><span class="org-block">: </span><span class="ATTRLIST-18"><span class="ATTRLIST-1"><span class="org-block">#fefefe</span></span></span><span class="org-block">;
    </span><span class="css-property"><span class="org-block">border</span></span><span class="org-block">: solid 1px </span><span class="ATTRLIST-15"><span class="ATTRLIST-2"><span class="org-block">#616161</span></span></span><span class="org-block">;
    </span><span class="css-property"><span class="org-block">border-radius</span></span><span class="org-block">: 4px;
    </span><span class="css-property"><span class="org-block">box-shadow</span></span><span class="org-block">: inset 0 -1px 2px </span><span class="ATTRLIST-18"><span class="ATTRLIST"><span class="org-block">#b0b0b0</span></span></span><span class="org-block">;
}
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Common HTML</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">7f96bffb-29f9-4dad-9df3-89f62db9c047</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-01 Sat 14:55&gt;</span>
<span class="org-special-keyword">:END:</span>

The org publishing mechanism supports inclusion of common HTML at the beginning
and the end of each published page, as described <span class="org-link"><a href="http://orgmode.org/manual/HTML-preamble-and-postamble.html">here</a></span>.

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Head</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes :tangle org/html/html_head.html</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">964b9f7f-8357-4c26-a22b-ab2925b139b1</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">html_head</span>
<span class="org-special-keyword">:END:</span>

In each page's <span class="org-verbatim">=&lt;head&gt;=</span> section, a few items are added:
- the <span class="org-link"><a href="nil:nil">CSS file</a></span> controlling the website appearance,
- some <span class="org-link"><a href="nil:nil">javascript code</a></span> used by the <span class="org-link"><a href="nil:nil">HTML postamble</a></span> buttons to link to the org
  file source (and a htmlized version of it).

<span class="org-meta-line">#+NAME: html-head</span>
<span class="org-block-begin-line">#+BEGIN_SRC html -r
</span><span class="org-block">&lt;</span><span class="function-name"><span class="org-block">link</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">rel</span></span><span class="org-block">='stylesheet' </span><span class="variable-name"><span class="org-block">href</span></span><span class="org-block">='/blog/css/site.css' </span><span class="variable-name"><span class="org-block">type</span></span><span class="org-block">='text/css'/&gt;
&lt;</span><span class="function-name"><span class="org-block">script</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">type</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"text/javascript"</span></span><span class="org-block">&gt;
    function rpl(expr, a, b) {
      var i = 0;
      while (i != -1) {
         i = expr.indexOf(a, i);
         if (i &gt;= 0) {
            expr = expr.substring(0, i) + b + expr.substring(i + a.length);
            i += b.length;
         }
      }
      return expr
    }

    function show_org_source(flag_html = false){(ref:html-head-js-src)
        //document.location.href = rpl(document.location.href, </span><span class="string"><span class="org-block">"html"</span></span><span class="org-block">, </span><span class="string"><span class="org-block">"org"</span></span><span class="org-block">);
        var re = /[\/]$/g;
        var html_url = document.location.href.replace(re, '/index.html');
        var out_ext = flag_html? "org.html": "org";
        window.open(rpl(html_url, </span><span class="string"><span class="org-block">"html"</span></span><span class="org-block">, out_ext), '_blank');
    }
&lt;/</span><span class="function-name"><span class="org-block">script</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Preamble</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes :tangle org/html/html_preamble.html</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">a279701a-63c3-4ecf-9705-76d277de52a2</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">html_preamble</span>
<span class="org-special-keyword">:END:</span>

The preamble contains the navigation bar with links to the website home, posts
and RSS.  It also adds a <span class="org-link"><a href="nil:nil">short text</a></span> before the webpage's content with the file
date and a pointer to access the help menu of the org-infojs script.

<span class="org-meta-line">#+NAME: html-preamble</span>
<span class="org-block-begin-line">#+BEGIN_SRC html -r
</span><span class="org-block">&lt;</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">class</span></span><span class="org-block">='topnav'&gt;
  &lt;</span><span class="function-name"><span class="org-block">ul</span></span><span class="org-block">&gt;
    &lt;</span><span class="function-name"><span class="org-block">li</span></span><span class="org-block">&gt;&lt;</span><span class="function-name"><span class="org-block">a</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">href</span></span><span class="org-block">='/blog/index.html'&gt;Home&lt;/</span><span class="function-name"><span class="org-block">a</span></span><span class="org-block">&gt;&lt;/</span><span class="function-name"><span class="org-block">li</span></span><span class="org-block">&gt;
    &lt;</span><span class="function-name"><span class="org-block">li</span></span><span class="org-block">&gt;&lt;</span><span class="function-name"><span class="org-block">a</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">href</span></span><span class="org-block">='/blog/blog.html'&gt;Blog&lt;/</span><span class="function-name"><span class="org-block">a</span></span><span class="org-block">&gt;&lt;/</span><span class="function-name"><span class="org-block">li</span></span><span class="org-block">&gt;
    &lt;</span><span class="function-name"><span class="org-block">li</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">class</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"right feed"</span></span><span class="org-block">&gt;&lt;</span><span class="function-name"><span class="org-block">a</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">href</span></span><span class="org-block">='/blog/rss.xml'&gt;RSS&lt;/</span><span class="function-name"><span class="org-block">a</span></span><span class="org-block">&gt;&lt;/</span><span class="function-name"><span class="org-block">li</span></span><span class="org-block">&gt;
  &lt;/</span><span class="function-name"><span class="org-block">ul</span></span><span class="org-block">&gt;
&lt;/</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block">&gt;

&lt;</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">class</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"foreword"</span></span><span class="org-block">&gt;(ref:html-foreword)
  [</span><span class="variable-name"><span class="org-block">%d</span></span><span class="org-block"> (last updated: </span><span class="variable-name"><span class="org-block">%C</span></span><span class="org-block">) Press &lt;</span><span class="function-name"><span class="org-block">kbd</span></span><span class="org-block">&gt;?&lt;/</span><span class="function-name"><span class="org-block">kbd</span></span><span class="org-block">&gt; for navigation help]
&lt;/</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Postamble</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes :tangle org/html/html_postamble.html</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">2e06602c-d7f7-4788-abb9-57f9f1e8efcb</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">html_postamble</span>
<span class="org-special-keyword">:END:</span>

The postamble is composed of a simple block showing the emacs and org-mode
versions used to build the page, along with buttons to access the source org
file, and an htmlized version.  The raw version should allow to reproduce the
output published on the website.

<span class="org-meta-line">#+NAME: html-postamble</span>
<span class="org-block-begin-line">#+BEGIN_SRC html
</span><span class="org-block">&lt;</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">id</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"show_source"</span></span><span class="org-block">&gt;
  &lt;</span><span class="function-name"><span class="org-block">input</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">type</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"button"</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">class</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"footer-button"</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">value</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"Show Org source (html)"</span></span><span class="org-block">
         </span><span class="variable-name"><span class="org-block">onClick</span></span><span class="org-block">='show_org_source(true)' /&gt;
  &lt;</span><span class="function-name"><span class="org-block">input</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">type</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"button"</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">class</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"footer-button"</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">value</span></span><span class="org-block">=</span><span class="string"><span class="org-block">"Show Org source (raw)"</span></span><span class="org-block">
         </span><span class="variable-name"><span class="org-block">onClick</span></span><span class="org-block">='show_org_source()' /&gt;
&lt;/</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block">&gt;
&lt;</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">class</span></span><span class="org-block">='footer'&gt;
  Last updated </span><span class="variable-name"><span class="org-block">%C.</span></span><span class="org-block"> &lt;</span><span class="function-name"><span class="org-block">br</span></span><span class="org-block">&gt;
  Built with </span><span class="variable-name"><span class="org-block">%c.</span></span><span class="org-block">
&lt;/</span><span class="function-name"><span class="org-block">div</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Main page</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes :tangle org/index.org</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">ee738399-bad2-4b0a-a129-ecb2c4b1e96f</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-01 Sat 18:17&gt;</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">index_org</span>
<span class="org-special-keyword">:END:</span>

The main page of the website is minimalist, it lists the most recent blog posts
by <span class="org-link"><a href="nil:nil">including</a></span> the top of the <span class="org-link"><a href="nil:nil">sitemap</a></span> and links to the <span class="org-link"><a href="nil:nil">full list of blog posts</a></span> and
the <span class="org-link"><a href="nil:nil">sitemap</a></span> itself.

<span class="org-meta-line">#+NAME: index-org</span>
<span class="org-block-begin-line">#+BEGIN_SRC org -r
</span><span class="org-block">,#+TITLE: misc/
,#+DATE: </span><span class="org-date"><span class="org-block">&lt;2016-10-02 Sun&gt;</span></span><span class="org-block">

Random articles about linux, emacs, data processing, etc.  This site and the
articles are built with </span><span class="org-link"><span class="org-block"><a href="https://gnu.org/s/emacs">[[https://gnu.org/s/emacs][emacs]]</a></span></span><span class="org-block"> and
</span><span class="org-link"><span class="org-block"><a href="http://orgmode.org">[[http://orgmode.org][org-mode]]</a></span></span><span class="org-block"> (using
</span><span class="org-link"><span class="org-block"><a href="http://orgmode.org/worg/code/org-info-js">[[http://orgmode.org/worg/code/org-info-js][org-js]]</a></span></span><span class="org-block">).

,* Blog

,#+INCLUDE: sitemap.org::*posts :lines "-5" :only-contents t(ref:main-inc-sitemap)

</span><span class="org-link"><span class="org-block"><a href="file:blog.org">[[file:blog.org][Older posts]]</a></span></span><span class="org-block">

,* </span><span class="org-link"><span class="org-block"><a href="file:sitemap.org">[[file:sitemap.org][Sitemap]]</a></span></span><span class="org-block">
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Blog page</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes :tangle org/blog.org</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">58d69e17-37cc-4c12-a1ed-56afd060bdc5</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-01 Sat 14:55&gt;</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">page-blog-posts</span>
<span class="org-special-keyword">:END:</span>

The blog page simply lists all the posts using the <span class="org-link"><a href="nil:nil">sitemap</a></span>.

<span class="org-meta-line">#+NAME: blog-org</span>
<span class="org-block-begin-line">#+BEGIN_SRC org
</span><span class="org-block">
,#+TITLE: Blog posts

All the blog posts:

,#+INCLUDE: sitemap.org::*posts :only-contents t
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Org header</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:mkdirp yes</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">a26c93a0-2ff5-4993-8d04-2afe280702f4</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-02 Sun 00:55&gt;</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">sec-org-setup</span>
<span class="org-special-keyword">:END:</span>

The <span class="org-verbatim">=setup.org=</span> file contains default headers added to the top of each org file
pushed as a blog post using the <span class="org-link"><a href="nil:nil">push-to-blog</a></span> function.  The additional header
performs the following:
- setup the path to the org-infojs source (local) and the table of contents
  defaults,
- add the <span class="org-verbatim">=:comments link=</span> header argument to allow for edits in the tangled
  file and use of <span class="org-verbatim">=org-detangle=</span>,
- prevents evaluation of source blocks by default,
- define common macros

<span class="org-meta-line">#+NAME: setup-org</span>
<span class="org-meta-line">#+HEADER: :tangle org/setup.org</span>
<span class="org-block-begin-line">#+BEGIN_SRC org
</span><span class="org-block">,#+INFOJS_OPT: toc:t tdepth:2 view:showall ftoc:t path:/blog/js/org-info.js
,#+PROPERTY: header-args :eval never
,#+PROPERTY: header-args+ :comments link
,#+STARTUP: nohideblocks
,#+MACRO: tt \nbsp{}
,#+MACRO: kbd call_el-common-kbd[:eval yes :results value raw :exports results]($1)
</span><span class="org-block-end-line">#+END_SRC
</span>
Along with header specifications, common source blocks are also included in each
file via the <span class="org-verbatim">=source-blocks.org=</span> file.
<span class="org-meta-line">#+NAME: source-blocks-org</span>
<span class="org-meta-line">#+HEADER: :tangle org/source-blocks.org</span>
<span class="org-block-begin-line">#+BEGIN_SRC org
</span><span class="org-block">,#+NAME: el-common-kbd
,#+BEGIN_SRC emacs-lisp :var x="" :exports none
(format "@@html:%s@@"
        (mapconcat
         (lambda (el)
           (format "&lt;kbd&gt;%s&lt;/kbd&gt;" el))
         (split-string x " ") " "))
,#+END_SRC
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Emacs setup</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:header-args+:</span> <span class="org-property-value">:tangle my-website.el</span>
<span class="org-special-keyword">:END:</span>

This section contains the emacs-lisp backend code used to produce the website
from the set of source org files.  While the org-publish mechanism handles most
of this, some specific items are handled manually.

When tangled, this section creates the <span class="org-verbatim">=my-website.el=</span> file which can then be
loaded from the emacs setup file (using <span class="org-verbatim">=(require 'my-website)=</span>).

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Header</span>

This first section creates the header for the <span class="org-verbatim">=my-website.el=</span> file.

<span class="org-meta-line">#+NAME: elisp-header</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">
</span><span class="comment-delimiter"><span class="org-block">;;; </span></span><span class="comment"><span class="org-block">my-website.el --- Personal website configuration
</span></span><span class="org-block">
</span><span class="comment-delimiter"><span class="org-block">;;; </span></span><span class="comment"><span class="org-block">Commentary:
</span></span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Defines functions for publishing a static website.  This file was produced
</span></span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">automatically from website.org.  See the website.org file for a full
</span></span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">description.
</span></span><span class="org-block">
</span><span class="comment-delimiter"><span class="org-block">;;; </span></span><span class="comment"><span class="org-block">Code:
</span></span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Sitemap</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">sitemap</span>
<span class="org-special-keyword">:END:</span>

The sitemap is used here to provide an automatically updated list of blog posts.

The idea is to generate a <span class="org-verbatim">=sitemap.org=</span> file which contains a subtree for blog
posts, sorted by date (most recent first).  Then, the org-mode <span class="org-verbatim">=#+INCLUDE=</span>
directive is used to display the blog posts (see the <span class="org-link"><a href="http://orgmode.org/manual/Include-files.html">documentation</a></span>) on any page.
A list of the 5 most recent posts is shown on the <span class="org-link"><a href="nil:nil">main page</a></span> and a full list is
included in the <span class="org-link"><a href="nil:nil">blog page</a></span>.  This keeps lists of posts up-to-date.

<span class="org-meta-line">#+NAME: elisp-sitemap-new</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/org-publish-org-sitemap</span></span><span class="org-block"> (title list)
  </span><span class="doc"><span class="org-block">"Sitemap generation function."</span></span><span class="org-block">
  (concat </span><span class="string"><span class="org-block">"#+TITLE: Sitemap\n\n"</span></span><span class="org-block">
          (org-list-to-subtree list)))

(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/org-publish-org-sitemap-format</span></span><span class="org-block"> (entry style project)
  </span><span class="doc"><span class="org-block">"Custom sitemap entry formatting: add date"</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">cond</span></span><span class="org-block"> ((not (directory-name-p entry))
         (format </span><span class="string"><span class="org-block">"<a href="file:%s">[[file:%s][(%s) %s]]</a>"</span></span><span class="org-block">
                 entry
                 (format-time-string </span><span class="string"><span class="org-block">"%Y-%m-%d"</span></span><span class="org-block">
                                     (org-publish-find-date entry project))
                 (org-publish-find-title entry project)))
        ((eq style 'tree)
         </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Return only last subdir.
</span></span><span class="org-block">         (file-name-nondirectory (directory-file-name entry)))
        (t entry)))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> RSS</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">rss</span>
<span class="org-special-keyword">:END:</span>

A simple RSS feed is also created using <span class="org-verbatim">=ox-rss=</span>.  It includes the first section
of the document as feed content (extracted using the
 <span class="org-link"><a href="nil:nil">=&#8482;/org-get-first-paragraph= function</a></span>).
The RSS feed is also limited to the latest 30 entries.

There are currently issues with the styling and images in the feed, but it is
sufficient for my simple use.

<span class="org-meta-line">#+NAME: elisp-rss</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp -r
</span><span class="org-block">
(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/org-get-first-paragraph</span></span><span class="org-block"> (file)(ref:func-get-paragraph)
  </span><span class="string"><span class="org-block">"Get string content of first paragraph of file."</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">with-temp-buffer</span></span><span class="org-block">
    (insert-file-contents file)
    (goto-char (point-min))
    (show-all)
    (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((first-begin (</span><span class="keyword"><span class="org-block">progn</span></span><span class="org-block">
                         (org-forward-heading-same-level 1)
                         (point)))
          (first-end (</span><span class="keyword"><span class="org-block">progn</span></span><span class="org-block">
                       (org-next-visible-heading 1)
                       (point))))
      (buffer-substring first-begin first-end))))

(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/org-rss-publish-to-rss</span></span><span class="org-block"> (plist filename pub-dir)
  </span><span class="doc"><span class="org-block">"Prepare rss.org file before exporting."</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((basedir (plist-get plist </span><span class="builtin"><span class="org-block">:base-directory</span></span><span class="org-block">))
         (postsdir (concat (file-name-as-directory basedir) </span><span class="string"><span class="org-block">"posts"</span></span><span class="org-block">)))
    (</span><span class="keyword"><span class="org-block">with-current-buffer</span></span><span class="org-block"> (find-file filename)
      (erase-buffer)
      (insert </span><span class="string"><span class="org-block">"#+TITLE: misc/ blog RSS\n"</span></span><span class="org-block">)
      (insert </span><span class="string"><span class="org-block">"#+SETUPFILE: setup.org\n"</span></span><span class="org-block">)
      </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">The following does not seem to work
</span></span><span class="org-block">      (insert (concat
               </span><span class="string"><span class="org-block">"#+HTML_HEAD: &lt;link rel=\"stylesheet\" type=\"text/css\""</span></span><span class="org-block">
               </span><span class="string"><span class="org-block">" href=\"/blog/css/site.css\" /&gt;\n\n"</span></span><span class="org-block">))
      (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((files-all
              (reverse (directory-files postsdir nil
                                        </span><span class="string"><span class="org-block">"[0-9-]+.*\\.org$"</span></span><span class="org-block">)))
             (files (subseq files-all 0 (min (length files-all) 30))))
        (</span><span class="keyword"><span class="org-block">dolist</span></span><span class="org-block"> (post files)
          (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((post-file (concat (file-name-as-directory postsdir) post))
                 (post-title (org-publish-find-title post-file))
                 (preview-str (&#8482;/org-get-first-paragraph post-file)))
            (insert (concat </span><span class="string"><span class="org-block">"* <a href="file:posts/">[[file:posts/"</a></span></span><span class="org-block"><a href="file:posts/"> post </a></span><span class="string"><span class="org-block"><a href="file:posts/">"]["</a></span></span><span class="org-block"><a href="file:posts/"> post-title </a></span><span class="string"><span class="org-block"><a href="file:posts/">"]]</a>\n\n"</span></span><span class="org-block">))
            (insert </span><span class="string"><span class="org-block">"*"</span></span><span class="org-block">)
            (insert preview-str)
            (newline 1)
            (insert (concat </span><span class="string"><span class="org-block">"<a href="file:posts/">[[file:posts/"</a></span></span><span class="org-block"><a href="file:posts/"> post </a></span><span class="string"><span class="org-block"><a href="file:posts/">"][(Read more)]]</a>\n\n"</span></span><span class="org-block">))))
        (save-buffer))))
  (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((user-mail-address </span><span class="string"><span class="org-block">")"</span></span><span class="org-block">)
        (org-export-with-broken-links t))
    (org-rss-publish-to-rss plist filename pub-dir)))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Mathjax path</span>

In order to use the website on secured connections (<span class="org-verbatim">=https=</span>), the <span class="org-verbatim">=https=</span>
version of the mathjax library is loaded.

<span class="org-meta-line">#+NAME: elisp-mathjax</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Use https for mathjax
</span></span><span class="org-block">(setcdr
 (assq 'path org-html-mathjax-options)
 '(</span><span class="string"><span class="org-block">"<a href="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML</a>"</span></span><span class="org-block">))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Custom backend</span>

The backend used for exporting org files to HTML is derived from the builtin
<span class="org-verbatim">=html=</span> backend, adding one functionality: the name of the tangle file for each
source block is shown in the block, as an overlay.

To achieve this, the tangle process must be first initiated, i.e. tangled blocks
must be collected using the <span class="org-verbatim">=org-babel-tangle-collect-blocks=</span> storing the
tangled filename for each block in a cache (the <span class="org-verbatim">=&#8482;/org-tangle-list-cache=</span>
variable).  Then, during export, the source blocks are filtered and the filename
is added to the source block <span class="org-verbatim">=&lt;pre&gt;=</span> tag.  Note that this is not valid CSS, but
it seems to work on most browsers, so it will do for now.


<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Preprocess buffer</span>

The <span class="org-verbatim">=&#8482;/org-export-collect-tangle=</span> function is responsible for collecting source
blocks for tangling and saving the output filename in the cache.

<span class="org-meta-line">#+NAME: elisp-html-tangle-gather</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="keyword"><span class="org-block">defvar</span></span><span class="org-block"> </span><span class="variable-name"><span class="org-block">&#8482;/org-tangle-list-cache</span></span><span class="org-block"> nil)
(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/org-export-collect-tangle</span></span><span class="org-block"> (backend)
  (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block"> &#8482;/org-tangle-list-cache nil)
  (</span><span class="keyword"><span class="org-block">when</span></span><span class="org-block"> (equal backend '&#8482;/html)
    (</span><span class="keyword"><span class="org-block">save-excursion</span></span><span class="org-block">
      (</span><span class="keyword"><span class="org-block">save-restriction</span></span><span class="org-block">
        (widen)
        (show-all)
        (org-babel-execute-buffer)
        (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((src-blocks (org-babel-tangle-collect-blocks)))
          (</span><span class="keyword"><span class="org-block">dolist</span></span><span class="org-block"> (src-lang src-blocks)
            (</span><span class="keyword"><span class="org-block">dolist</span></span><span class="org-block"> (src-block (cdr src-lang))
              (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((src-block-name (nth 3 src-block))
                    (src-block-tangle (cdr (assoc </span><span class="builtin"><span class="org-block">:tangle</span></span><span class="org-block"> (nth 4 src-block)))))
                (add-to-list '&#8482;/org-tangle-list-cache
                             `(,src-block-name . ,src-block-tangle))))))))))
</span><span class="org-block-end-line">#+END_SRC
</span>
The function is added as a preprocessing hook, since this hook is run on the
un-modified input buffer.

<span class="org-meta-line">#+NAME: elisp-html-tangle-preproc-hook</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">(add-hook 'org-export-before-processing-hook '&#8482;/org-export-collect-tangle)
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-3">*** </span><span class="org-done">DONE</span><span class="org-level-3"> Source block processing</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">src-block-tangle</span>
<span class="org-special-keyword">:END:</span>

The derived backend modifies the source block handling function by inserting the
name of the tangled file.  The regular <span class="org-verbatim">=html=</span> exporter is first used to <span class="org-link"><a href="nil:nil">produce
the html code for the source block</a></span> (including syntax highlighting).  The html
output is then modified by inserting a <span class="org-verbatim">=&lt;div&gt;=</span> block, fixed at the bottom right
of the source block.  The CSS class <span class="org-verbatim">=src-label=</span> is added to the div block to
allow for customization of the appearance.

<span class="org-meta-line">#+NAME: elisp-html-tangle-process</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp -r
</span><span class="org-block">(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/html-src-block</span></span><span class="org-block"> (src-block contents info)
  </span><span class="doc"><span class="org-block">"Transcode a SRC-BLOCK element from Org to HTML.
CONTENTS is nil.  INFO is a plist used as a communication
  channel.  Add name of tangle file to source block (this
  requires a preprocessing hook to be added with
  `</span></span><span class="constant"><span class="doc"><span class="org-block">&#8482;/org-export-collect-tangle</span></span></span><span class="doc"><span class="org-block">'."</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((src-block-name (org-element-property </span><span class="builtin"><span class="org-block">:name</span></span><span class="org-block"> src-block))
         (src-block-tangle
          (</span><span class="keyword"><span class="org-block">when</span></span><span class="org-block"> &#8482;/org-tangle-list-cache
            (cdr (assoc src-block-name &#8482;/org-tangle-list-cache))))
         (export-out (org-export-with-backend(ref:proc-src-html)
                      'html src-block contents info)))
    (</span><span class="keyword"><span class="org-block">when</span></span><span class="org-block"> (</span><span class="keyword"><span class="org-block">and</span></span><span class="org-block"> src-block-tangle (&gt; (length src-block-tangle) 0)
               (not (string= src-block-tangle </span><span class="string"><span class="org-block">"no"</span></span><span class="org-block">)))
      (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((src-start-pat </span><span class="string"><span class="org-block">"</span></span><span class="regexp-grouping-backslash"><span class="string"><span class="org-block">\\</span></span></span><span class="regexp-grouping-construct"><span class="string"><span class="org-block">(</span></span></span><span class="string"><span class="org-block">&lt;pre class=\"src src-[</span></span><span class="negation-char"><span class="string"><span class="org-block">^</span></span></span><span class="string"><span class="org-block">&gt;]+&gt;</span></span><span class="regexp-grouping-backslash"><span class="string"><span class="org-block">\\</span></span></span><span class="regexp-grouping-construct"><span class="string"><span class="org-block">)</span></span></span><span class="string"><span class="org-block">"</span></span><span class="org-block">))
        (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block"> export-out
              (replace-regexp-in-string
               src-start-pat
               (concat </span><span class="string"><span class="org-block">"\\1&lt;div style=\"position: absolute; bottom: 0;"</span></span><span class="org-block">
                       </span><span class="string"><span class="org-block">" right: 0; text-align:right;\" class=\"src-label\"&gt;["</span></span><span class="org-block">
                       src-block-tangle </span><span class="string"><span class="org-block">"]&lt;/div&gt;"</span></span><span class="org-block">)
               export-out))))
      export-out))
</span><span class="org-block-end-line">#+END_SRC
</span>
Finally, the derived backend is defined, using the custom translation function
for source blocks.  Everything else is handled by the regular <span class="org-verbatim">=html=</span> backend.

<span class="org-meta-line">#+NAME: elisp-html-tangle-add-backend</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">(org-export-define-derived-backend '&#8482;/html 'html
  </span><span class="builtin"><span class="org-block">:translate-alist</span></span><span class="org-block"> '((src-block . &#8482;/html-src-block)))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Publishing function</span>

A simple wrapper function is created to export to the custom backend.  It is
almost identical to <span class="org-verbatim">=org-html-publish-to-html=</span> with the exception of the actual
backend used.

<span class="org-meta-line">#+NAME: elisp-html-publish-func</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/org-html-publish-to-&#8482;-html</span></span><span class="org-block"> (plist filename pub-dir)
  </span><span class="doc"><span class="org-block">"Publish an org file to HTML.

FILENAME is the filename of the Org file to be published.  PLIST
is the property list for the given project.  PUB-DIR is the
publishing directory.

Return output file name."</span></span><span class="org-block">
  (org-publish-org-to '&#8482;/html filename
              (concat </span><span class="string"><span class="org-block">"."</span></span><span class="org-block"> (</span><span class="keyword"><span class="org-block">or</span></span><span class="org-block"> (plist-get plist </span><span class="builtin"><span class="org-block">:html-extension</span></span><span class="org-block">)
                      org-html-extension
                      </span><span class="string"><span class="org-block">"html"</span></span><span class="org-block">))
              plist pub-dir))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Org-publishing setup</span>

The publishing configuration is set via the <span class="org-verbatim">=org-publish-project-alist=</span>
variable.  The following function returns a list of project properties to use
with <span class="org-verbatim">=org-publish-project-alist=</span>.

It relies on the <span class="org-verbatim">=&#8482;/get-perso=</span> utility to get the root folder
(line<span class="org-macro">{{{tt}}}</span><span class="org-link"><a href="nil:nil">(root-perso)</a></span>).  This can be replaced by a full path to the website
root folder.

The function defines the paths to the org source, the destination, the
attachment folders, etc. and loads the content of the custom HTML <span class="org-link"><a href="nil:nil">head</a></span>, <span class="org-link"><a href="nil:nil">preamble</a></span>
and <span class="org-link"><a href="nil:nil">postamble</a></span>.  It creates multiple projects to control the publishing of the
website:
- <span class="org-verbatim">=w-org=</span> is the main publishing of org files to html.  It uses two
  <span class="org-verbatim">=publishing-function=</span> entries: one to generate the html file and one to export
  a complete org file (which can be accessed on the output webpage by clicking
  on the buttons defined in the <span class="org-link"><a href="nil:nil">footer</a></span>).  The <span class="org-link"><a href="nil:nil">sitemap</a></span> generation is also
  configured in this project.  Additional features include the insertion of a
  RSS link to the header, and the suppression of TODO items and statistics
  cookies.
- <span class="org-verbatim">=w-images=</span> simply publishes images in the <span class="org-verbatim">=images/=</span> folder using the
  <span class="org-verbatim">=org-publish-attachment=</span> function.
- <span class="org-verbatim">=w-js=</span> publishes the javascript files in the <span class="org-verbatim">=js/=</span> folder.
- <span class="org-verbatim">=w-css=</span> publishes the <span class="org-link"><a href="nil:nil">CSS file</a></span> in the <span class="org-verbatim">=css/=</span> folder.
- <span class="org-verbatim">=w-rss=</span> generates the <span class="org-link"><a href="nil:nil">RSS</a></span> feed using the <span class="org-verbatim">=ox-rss=</span> package.
- Finally, <span class="org-verbatim">=website=</span> is a meta project which simply encapsulates all the other
  projects.

<span class="org-meta-line">#+NAME: elisp-publish-spec</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp -r
</span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Get project settings
</span></span><span class="org-block">(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/get-publish-project-spec</span></span><span class="org-block"> ()
  </span><span class="doc"><span class="org-block">"Return project settings for use with `</span></span><span class="constant"><span class="doc"><span class="org-block">org-publish-project-alist</span></span></span><span class="doc"><span class="org-block">'."</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((website-root (file-name-as-directory
                        (&#8482;/get-perso </span><span class="string"><span class="org-block">"website-root"</span></span><span class="org-block">)))</span><span class="warning"><span class="org-block">(ref:root-perso)</span></span><span class="org-block">
         (website-org (file-name-as-directory
                       (concat website-root </span><span class="string"><span class="org-block">"org"</span></span><span class="org-block">)))
         (website-www (file-name-as-directory
                       (concat website-root </span><span class="string"><span class="org-block">"www"</span></span><span class="org-block">)))
         (website-org-img (file-name-as-directory
                           (concat website-org </span><span class="string"><span class="org-block">"images"</span></span><span class="org-block">)))
         (website-www-img (file-name-as-directory
                           (concat website-www </span><span class="string"><span class="org-block">"images"</span></span><span class="org-block">)))
         (website-org-js (file-name-as-directory
                          (concat website-org </span><span class="string"><span class="org-block">"js"</span></span><span class="org-block">)))
         (website-www-js (file-name-as-directory
                          (concat website-www </span><span class="string"><span class="org-block">"js"</span></span><span class="org-block">)))
         (website-org-css (file-name-as-directory
                           (concat website-org </span><span class="string"><span class="org-block">"css"</span></span><span class="org-block">)))
         (website-www-css (file-name-as-directory
                           (concat website-www </span><span class="string"><span class="org-block">"css"</span></span><span class="org-block">)))
         (website-org-html (file-name-as-directory
                            (concat website-org </span><span class="string"><span class="org-block">"html"</span></span><span class="org-block">)))
         (website-org-posts (file-name-as-directory
                             (concat website-org </span><span class="string"><span class="org-block">"posts"</span></span><span class="org-block">)))
         (get-content (</span><span class="keyword"><span class="org-block">lambda</span></span><span class="org-block"> (x)
                        (</span><span class="keyword"><span class="org-block">with-temp-buffer</span></span><span class="org-block">
                          (insert-file-contents (concat website-org-html
                                                        x))
                          (buffer-string))))
         (website-html-head (funcall get-content </span><span class="string"><span class="org-block">"html_head.html"</span></span><span class="org-block">))
         (website-html-preamble (funcall get-content </span><span class="string"><span class="org-block">"html_preamble.html"</span></span><span class="org-block">))
         (website-html-postamble (funcall get-content </span><span class="string"><span class="org-block">"html_postamble.html"</span></span><span class="org-block">)))
    `(
      (</span><span class="string"><span class="org-block">"w-org"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:base-directory</span></span><span class="org-block"> ,website-org
       </span><span class="builtin"><span class="org-block">:base-extension</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"org"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:recursive</span></span><span class="org-block"> t
       </span><span class="builtin"><span class="org-block">:exclude</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"setup\\.org</span></span><span class="regexp-grouping-backslash"><span class="string"><span class="org-block">\\</span></span></span><span class="regexp-grouping-construct"><span class="string"><span class="org-block">|</span></span></span><span class="string"><span class="org-block">website\\.org</span></span><span class="regexp-grouping-backslash"><span class="string"><span class="org-block">\\</span></span></span><span class="regexp-grouping-construct"><span class="string"><span class="org-block">|</span></span></span><span class="string"><span class="org-block">rss\\.org"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:publishing-directory</span></span><span class="org-block"> ,website-www
       </span><span class="builtin"><span class="org-block">:publishing-function</span></span><span class="org-block"> (&#8482;/org-html-publish-to-&#8482;-html
                             org-org-publish-to-org)
       </span><span class="builtin"><span class="org-block">:html-extension</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"html"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:htmlized-source</span></span><span class="org-block"> t
       </span><span class="builtin"><span class="org-block">:html-doctype</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"html5"</span></span><span class="org-block">
       </span><span class="comment-delimiter"><span class="org-block">;;</span></span><span class="comment"><span class="org-block">:html-html5-fancy t
</span></span><span class="org-block">       </span><span class="builtin"><span class="org-block">:language</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"en"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:section-numbers</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:auto-sitemap</span></span><span class="org-block"> t
       </span><span class="builtin"><span class="org-block">:sitemap-date-format</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"Published: %a %b %d %Y"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:sitemap-sort-files</span></span><span class="org-block"> anti-chronologically
       </span><span class="builtin"><span class="org-block">:sitemap-function</span></span><span class="org-block"> &#8482;/org-publish-org-sitemap
       </span><span class="builtin"><span class="org-block">:sitemap-format-entry</span></span><span class="org-block"> &#8482;/org-publish-org-sitemap-format
       </span><span class="builtin"><span class="org-block">:with-toc</span></span><span class="org-block"> nil </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">except when otherwise stated
</span></span><span class="org-block">       </span><span class="builtin"><span class="org-block">:with-date</span></span><span class="org-block"> t
       </span><span class="builtin"><span class="org-block">:headline-levels</span></span><span class="org-block"> 4
       </span><span class="builtin"><span class="org-block">:with-sub-superscript</span></span><span class="org-block"> t
       </span><span class="builtin"><span class="org-block">:with-todo-keywords</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:with-statistics-cookies</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:with-email</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:html-link-home</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"/blog/index.html"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:html-link-up</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"/blog/index.html"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:html-head-extra</span></span><span class="org-block">
       </span><span class="string"><span class="org-block">"&lt;link rel=\"alternate\" type=\"application/rss+xml\"
                href=\"/blog/rss.xml\"
                title=\"RSS feed\"&gt;"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:html-head</span></span><span class="org-block"> ,website-html-head
       </span><span class="builtin"><span class="org-block">:html-preamble</span></span><span class="org-block"> ,website-html-preamble
       </span><span class="builtin"><span class="org-block">:html-postamble</span></span><span class="org-block"> ,website-html-postamble)

      (</span><span class="string"><span class="org-block">"w-images"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:base-directory</span></span><span class="org-block"> ,website-org-img
       </span><span class="builtin"><span class="org-block">:base-extension</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"jpg</span></span><span class="regexp-grouping-backslash"><span class="string"><span class="org-block">\\</span></span></span><span class="regexp-grouping-construct"><span class="string"><span class="org-block">|</span></span></span><span class="string"><span class="org-block">gif</span></span><span class="regexp-grouping-backslash"><span class="string"><span class="org-block">\\</span></span></span><span class="regexp-grouping-construct"><span class="string"><span class="org-block">|</span></span></span><span class="string"><span class="org-block">png"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:recursive</span></span><span class="org-block"> t
       </span><span class="builtin"><span class="org-block">:publishing-directory</span></span><span class="org-block"> ,website-www-img
       </span><span class="builtin"><span class="org-block">:publishing-function</span></span><span class="org-block"> org-publish-attachment)

      (</span><span class="string"><span class="org-block">"w-js"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:base-directory</span></span><span class="org-block"> ,website-org-js
       </span><span class="builtin"><span class="org-block">:base-extension</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"js"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:publishing-directory</span></span><span class="org-block"> ,website-www-js
       </span><span class="builtin"><span class="org-block">:publishing-function</span></span><span class="org-block"> org-publish-attachment)

      (</span><span class="string"><span class="org-block">"w-css"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:base-directory</span></span><span class="org-block"> ,website-org-css
       </span><span class="builtin"><span class="org-block">:base-extension</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"css"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:publishing-directory</span></span><span class="org-block"> ,website-www-css
       </span><span class="builtin"><span class="org-block">:publishing-function</span></span><span class="org-block"> org-publish-attachment)

      (</span><span class="string"><span class="org-block">"w-rss"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:base-directory</span></span><span class="org-block"> ,website-org
       </span><span class="builtin"><span class="org-block">:base-extension</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"org"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:include</span></span><span class="org-block"> (</span><span class="string"><span class="org-block">"rss.org"</span></span><span class="org-block">)
       </span><span class="builtin"><span class="org-block">:exclude</span></span><span class="org-block"> </span><span class="string"><span class="org-block">".*"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:with-author</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:with-todo-keywords</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:with-statistics-cookies</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:with-email</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:html-link-home</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"/blog/index.html"</span></span><span class="org-block">
       </span><span class="builtin"><span class="org-block">:publishing-directory</span></span><span class="org-block"> ,website-www
       </span><span class="builtin"><span class="org-block">:publishing-function</span></span><span class="org-block"> &#8482;/org-rss-publish-to-rss
       </span><span class="builtin"><span class="org-block">:section-numbers</span></span><span class="org-block"> nil
       </span><span class="builtin"><span class="org-block">:html-link-use-abs-url</span></span><span class="org-block"> nil)

      (</span><span class="string"><span class="org-block">"website"</span></span><span class="org-block"> </span><span class="builtin"><span class="org-block">:components</span></span><span class="org-block">
       (</span><span class="string"><span class="org-block">"w-org"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"w-images"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"w-js"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"w-css"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"w-rss"</span></span><span class="org-block">)))))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Publishing wrapper function</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">el-publish-wrapper</span>
<span class="org-special-keyword">:END:</span>

The <span class="org-verbatim">=&#8482;/publish-website=</span> function is the entry point to generate the website
from the source org files.  It sets up the configuration lists, defines some
simple options and calls the publishing function.

The website is updated when calling <span class="org-verbatim">=(&#8482;/publish-website)=</span>, which only publishes
newly modified files.  When used with additional arguments, a full update can be
forced: <span class="org-verbatim">=(&#8482;/publish-website "website" t)=</span>.

<span class="org-meta-line">#+NAME: elisp-publish-func</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">org-publish for website
</span></span><span class="org-block">(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/publish-website</span></span><span class="org-block"> (</span><span class="type"><span class="org-block">&amp;optional</span></span><span class="org-block"> project force)
  </span><span class="doc"><span class="org-block">"Publish personal website."</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">interactive</span></span><span class="org-block">)
  (</span><span class="keyword"><span class="org-block">unless</span></span><span class="org-block"> project (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block"> project </span><span class="string"><span class="org-block">"website"</span></span><span class="org-block">))
  (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((org-publish-project-alist (&#8482;/get-publish-project-spec))
        (org-export-date-timestamp-format </span><span class="string"><span class="org-block">"%Y-%m-%d"</span></span><span class="org-block">)
        (org-todo-keywords '((sequence </span><span class="string"><span class="org-block">"TODO"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"REVIEW"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"|"</span></span><span class="org-block">
                                       </span><span class="string"><span class="org-block">"DONE"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"DEFERRED"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"ABANDONED"</span></span><span class="org-block">))))
    (org-publish-project project force)))
</span><span class="org-block-end-line">#+END_SRC
</span>


<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Push org-file to blog</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">el-push-to-blog</span>
<span class="org-special-keyword">:END:</span>

The mechanism to publish new posts uses the <span class="org-verbatim">=&#8482;/push-to-blog=</span> function to convert
a standalone org file into a post.  The function performs the following:
- add a <span class="org-verbatim">=#+SETUPFILE=</span> line to the header (the content of the setup file is
  described <span class="org-link"><a href="nil:nil">here</a></span>),
- format the output filename with the post date preceding the title
  (e.g. <span class="org-verbatim">=YYYY-MM-DD-Post_title.org=</span>),
- search for TODO items, exit if any is found,
- moves file links (images) to a subfolder of the <span class="org-verbatim">=org/images/=</span> folder named after
  the formatted output filename (e.g. <span class="org-verbatim">=YYYY-MM-DD-Post_title/=</span>),
- modify links to files to point to the copy location,
- finally, save the modified org file to the <span class="org-verbatim">=org/posts/=</span> folder.

<span class="org-meta-line">#+NAME: elisp-push-to-blog</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Push to blog
</span></span><span class="org-block">(</span><span class="keyword"><span class="org-block">defun</span></span><span class="org-block"> </span><span class="function-name"><span class="org-block">&#8482;/push-to-blog</span></span><span class="org-block"> (org-file)
  </span><span class="doc"><span class="org-block">"Add ORG-FILE to personal blog."</span></span><span class="org-block">
  (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((blog-dir (concat
                    (file-name-as-directory (&#8482;/get-perso </span><span class="string"><span class="org-block">"website-root"</span></span><span class="org-block">))
                    (file-name-as-directory </span><span class="string"><span class="org-block">"org"</span></span><span class="org-block">)))
         (post-dir (concat
                    (file-name-as-directory blog-dir)
                    (file-name-as-directory </span><span class="string"><span class="org-block">"posts"</span></span><span class="org-block">)))
         (img-dir-base (concat
                        (file-name-as-directory blog-dir)
                        (file-name-as-directory </span><span class="string"><span class="org-block">"images"</span></span><span class="org-block">)))
         (file-base (file-name-base org-file))
         post-date
         (has-date nil)
         out-file
         (org-inhibit-startup t)
         (visiting (find-buffer-visiting org-file))
         (buffer (</span><span class="keyword"><span class="org-block">or</span></span><span class="org-block"> visiting (find-file-noselect org-file)))
         (org-tree (</span><span class="keyword"><span class="org-block">with-current-buffer</span></span><span class="org-block"> buffer
                     (org-element-parse-buffer))))
    (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> (setupfile-added-p)
      </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Add SETUPFILE entry to tree, parse TITLE and DATE
</span></span><span class="org-block">      (org-element-map
          org-tree 'keyword
        (</span><span class="keyword"><span class="org-block">lambda</span></span><span class="org-block"> (r)
          (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((key (org-element-property </span><span class="builtin"><span class="org-block">:key</span></span><span class="org-block"> r))
                (value (org-element-property </span><span class="builtin"><span class="org-block">:value</span></span><span class="org-block"> r)))
            (</span><span class="keyword"><span class="org-block">unless</span></span><span class="org-block"> setupfile-added-p
              (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((elt-setup (org-element-copy r))
                    (elt-src-block (org-element-copy r)))
                (org-element-put-property elt-src-block </span><span class="builtin"><span class="org-block">:key</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"INCLUDE"</span></span><span class="org-block">)
                (org-element-put-property elt-src-block </span><span class="builtin"><span class="org-block">:value</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"../source-blocks.org"</span></span><span class="org-block">)
                (org-element-insert-before elt-src-block r)
                (org-element-put-property elt-setup </span><span class="builtin"><span class="org-block">:key</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"SETUPFILE"</span></span><span class="org-block">)
                (org-element-put-property elt-setup </span><span class="builtin"><span class="org-block">:value</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"../setup.org"</span></span><span class="org-block">)
                (org-element-insert-before elt-setup r))
              (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block"> setupfile-added-p t))
            (</span><span class="keyword"><span class="org-block">cond</span></span><span class="org-block"> ((string= key </span><span class="string"><span class="org-block">"TITLE"</span></span><span class="org-block">)
                   (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block"> out-file
                         (replace-regexp-in-string </span><span class="string"><span class="org-block">"<a href="nil:nil">[[:space:]]</a>+"</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"_"</span></span><span class="org-block"> value)))
                  ((string= key </span><span class="string"><span class="org-block">"DATE"</span></span><span class="org-block">)
                   (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block"> post-date
                         (format-time-string
                          </span><span class="string"><span class="org-block">"%Y-%m-%d"</span></span><span class="org-block">
                          (org-time-string-to-time value))))))
          (</span><span class="keyword"><span class="org-block">and</span></span><span class="org-block"> out-file post-date setupfile-added-p))
        nil t)
      (</span><span class="keyword"><span class="org-block">when</span></span><span class="org-block"> (not (</span><span class="keyword"><span class="org-block">and</span></span><span class="org-block"> post-date out-file setupfile-added-p))
        (</span><span class="warning"><span class="org-block">error</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"TITLE and DATE must be defined"</span></span><span class="org-block">)))
    </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Look for remaining TODO
</span></span><span class="org-block">    (</span><span class="keyword"><span class="org-block">let</span></span><span class="org-block"> ((has-todo nil))
      (org-element-map org-tree 'headline
        (</span><span class="keyword"><span class="org-block">lambda</span></span><span class="org-block"> (r)
          (</span><span class="keyword"><span class="org-block">setq</span></span><span class="org-block">
           has-todo (</span><span class="keyword"><span class="org-block">or</span></span><span class="org-block"> has-todo
                        (equal 'todo
                               (org-element-property </span><span class="builtin"><span class="org-block">:todo-type</span></span><span class="org-block"> r))))
          has-todo)
        nil t)
      (</span><span class="keyword"><span class="org-block">when</span></span><span class="org-block"> has-todo
        (</span><span class="warning"><span class="org-block">error</span></span><span class="org-block"> </span><span class="string"><span class="org-block">"Remaining TODO items in file"</span></span><span class="org-block">)))
    (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((base-fname (concat post-date </span><span class="string"><span class="org-block">"-"</span></span><span class="org-block"> out-file))
           (out-file-full (concat post-dir base-fname </span><span class="string"><span class="org-block">".org"</span></span><span class="org-block">))
           (img-dir (concat img-dir-base base-fname)))
      </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Copy images and update links
</span></span><span class="org-block">      (org-element-map org-tree 'link
        (</span><span class="keyword"><span class="org-block">lambda</span></span><span class="org-block"> (r)
          (</span><span class="keyword"><span class="org-block">when</span></span><span class="org-block"> (string= (org-element-property </span><span class="builtin"><span class="org-block">:type</span></span><span class="org-block"> r) </span><span class="string"><span class="org-block">"file"</span></span><span class="org-block">)
            (</span><span class="keyword"><span class="org-block">let*</span></span><span class="org-block"> ((link-file (org-element-property </span><span class="builtin"><span class="org-block">:path</span></span><span class="org-block"> r))
                   (link-file-base (file-name-base link-file))
                   (link-file-ext (file-name-extension link-file t))
                   (out-link (concat (file-name-as-directory img-dir)
                                     link-file-base link-file-ext))
                   (img-path (concat </span><span class="string"><span class="org-block">"../images/"</span></span><span class="org-block">
                                     (file-name-as-directory base-fname)
                                     link-file-base link-file-ext)))
              </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Copy file
</span></span><span class="org-block">              (mkdir img-dir t)
              (copy-file link-file out-link t)
              </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Update link target
</span></span><span class="org-block">              (org-element-put-property r </span><span class="builtin"><span class="org-block">:path</span></span><span class="org-block"> img-path)
              (setcar (org-element-contents r) (concat </span><span class="string"><span class="org-block">"file:"</span></span><span class="org-block"> img-path))))))
      </span><span class="comment-delimiter"><span class="org-block">;; </span></span><span class="comment"><span class="org-block">Write output
</span></span><span class="org-block">      (</span><span class="keyword"><span class="org-block">with-current-buffer</span></span><span class="org-block"> (find-file out-file-full)
        (erase-buffer)
        (insert (org-element-interpret-data org-tree))
        (save-buffer)))))
</span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Footer</span>

This block closes the <span class="org-verbatim">=my-website.el=</span> file.

<span class="org-meta-line">#+NAME: elisp-footer</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp
</span><span class="org-block">
(</span><span class="keyword"><span class="org-block">provide</span></span><span class="org-block"> '</span><span class="constant"><span class="org-block">my-website</span></span><span class="org-block">)
</span><span class="comment-delimiter"><span class="org-block">;;; </span></span><span class="comment"><span class="org-block">my-website.el ends here
</span></span><span class="org-block-end-line">#+END_SRC
</span>

<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Resources                                                   </span><span class="org-tag"><span class="org-level-1">:noexport:</span></span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">f3ed1959-7fca-411c-b1bf-26636aa54659</span>
<span class="org-special-keyword">:PUBDATE:</span>  <span class="org-date">&lt;2016-10-01 Sat 21:51&gt;</span>
<span class="org-special-keyword">:END:</span>

<span class="org-level-2">** </span><span class="org-done">DONE</span><span class="org-level-2"> Blogs</span>
<span class="org-special-keyword">:PROPERTIES:</span>
<span class="org-special-keyword">:ID:</span>       <span class="org-property-value">35175cd5-e1ea-44ba-af48-eda2320f9e60</span>
<span class="org-special-keyword">:END:</span>

- <span class="org-list-dt"><span class="org-link"><a href="http://bastibe.de/2013-11-13-blogging-with-emacs.html">http://bastibe.de/2013-11-13-blogging-with-emacs.html</a></span></span><span class="org-list-dt"> ::</span> advice org-rss to
  include full text on level 2 headlines
- <span class="org-link"><a href="http://emacs-doctor.com/blogging-from-emacs.html">http://emacs-doctor.com/blogging-from-emacs.html</a></span>
- <span class="org-link"><a href="http://endlessparentheses.com/how-i-blog-one-year-of-posts-in-a-single-org-file.html">http://endlessparentheses.com/how-i-blog-one-year-of-posts-in-a-single-org-file.html</a></span>
- <span class="org-link"><a href="https://github.com/howardabrams/dot-files/blob/master/emacs-blog.org">https://github.com/howardabrams/dot-files/blob/master/emacs-blog.org</a></span>
- <span class="org-link"><a href="http://www.john2x.com/blog/blogging-with-orgmode.html">http://www.john2x.com/blog/blogging-with-orgmode.html</a></span>
- <span class="org-link"><a href="https://ogbe.net/blog/blogging_with_org.html">https://ogbe.net/blog/blogging_with_org.html</a></span>
- <span class="org-link"><a href="http://nicolas.petton.fr/blog/blogging-with-org-mode.html">http://nicolas.petton.fr/blog/blogging-with-org-mode.html</a></span>


<span class="org-level-1">* </span><span class="org-done">DONE</span><span class="org-level-1"> Notes                                                       </span><span class="org-tag"><span class="org-level-1">:noexport:</span></span>

- Fix RSS issues
- Tag system
- Link between articles
- Improve CSS
</pre>
  </body>
</html>
